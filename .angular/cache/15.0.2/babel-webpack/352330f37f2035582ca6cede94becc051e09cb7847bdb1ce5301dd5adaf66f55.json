{"ast":null,"code":"import _asyncToGenerator from \"/home/squanch/bk/campus-club/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CreateEventComponent } from './create-event/create-event.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/material/button\";\nimport * as i5 from \"./auth/auth.component\";\nimport * as i6 from \"./map/map.component\";\nimport * as i7 from \"./cards/cards.component\";\nfunction AppComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function AppComponent_div_6_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.openDialog());\n    });\n    i0.ɵɵtext(2, \"Create Event\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AppComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"app-auth\", 11);\n    i0.ɵɵlistener(\"auth\", function AppComponent_div_9_Template_app_auth_auth_1_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.recieveAuth($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AppComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"app-auth\", 13);\n    i0.ɵɵlistener(\"event_list_init\", function AppComponent_div_12_Template_app_auth_event_list_init_1_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.recieveEventList($event));\n    })(\"auth\", function AppComponent_div_12_Template_app_auth_auth_1_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.recieveAuth($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AppComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"div\", 14)(2, \"div\", 15)(3, \"app-cards\", 16);\n    i0.ɵɵlistener(\"event_list_joined\", function AppComponent_div_13_Template_app_cards_event_list_joined_3_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.recieveEventList($event));\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(4, \"div\", 17);\n    i0.ɵɵelement(5, \"app-map\", 18);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"event_list\", ctx_r3.event_list)(\"user\", ctx_r3.user);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"user\", ctx_r3.user)(\"event_list\", ctx_r3.event_list);\n  }\n}\nexport class AppComponent {\n  constructor(dialog) {\n    this.dialog = dialog;\n    this.title = 'campus_meet';\n    this.new_event = {\n      dateTimeStart: \"\",\n      dateTimeEnd: \"\",\n      title: \"Event test push\",\n      creator: \"Charles\",\n      descritption: \"Test event to push\",\n      attendees: '[\"Charles\",\"Rosh\",\"Kendal\",\"Doui\"]',\n      coordinates: '[\"123W\",\"456N\"]',\n      tags: '[\"test tag\"]',\n      groups: '[\"all\"]',\n      id: \"\"\n    };\n  }\n  // --------- Demo event list purposes only --------- \n  recieveAuth($event) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.user = $event;\n      console.log(_this.user); // THIS IS THE AUTH OBJECT WITH ALL USER DATA\n      _this.event_list = yield _this.pullEvents(_this.event_list);\n    })();\n  }\n  recieveEventList($event) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.event_list = yield _this2.pullEvents(_this2.event_list);\n    })();\n  }\n  ngOnInit() {\n    return _asyncToGenerator(function* () {})();\n  } // pull events from db on page load\n\n  pullEvents(event_list) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      // Fetch the events when funciton is called.\n      console.log(\"Pulling events! \", event_list);\n      let request = {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\n        }\n      };\n      event_list = yield fetch('http://127.0.0.1:3000/api/event', request).then(response => response.json()).then(user => {\n        return user;\n      }).catch();\n      if (event_list) {\n        let event_list_len = event_list['documents'].length;\n        for (let i = 0; i < event_list_len; i++) {\n          let lati = event_list['documents'][i].coordinates[0];\n          let long = event_list['documents'][i].coordinates[1];\n          _this3.center = {\n            lat: lati,\n            lng: long\n          };\n          event_list['documents'][i].coordinates = _this3.center;\n          let attendees = event_list['documents'][i].attendees;\n          if (_this3.user) console.log(\"USER IN EVENT\", _this3.user.firstName + _this3.user.lastName[0], attendees);\n          if (_this3.user && attendees.includes(_this3.user?.firstName + _this3.user?.lastName[0])) {\n            // check if a member of, if true, render a leave button\n            console.log(\"Found a user\");\n            event_list['documents'][i].id = true;\n          } else {\n            event_list['documents'][i].id = false;\n          }\n        }\n        console.log(event_list);\n        return event_list['documents'];\n      }\n    })();\n  }\n  /*async createEvent() {\n       // this.new_event is the form body.\n       // sends new event, the PULLs updated event list!!!!\n       var formBody: any = [];\n    for (var property in this.new_event) {\n      var encodedKey = encodeURIComponent(property);\n      var encodedValue = encodeURIComponent(this.new_event[property]);\n      formBody.push(encodedKey + \"=\" + encodedValue);\n    }\n    formBody = formBody.join(\"&\");\n       let request: RequestInit = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8'\n      },\n      body: formBody\n    }\n       fetch('http://127.0.0.1:3000/api/event',request)\n       console.log(\"Need to wait for db to write new event\")\n    setTimeout(()=>{},250);\n    console.log(\"Done waiting, now pull!\")\n       this.event_list = await this.pullEvents(this.event_list) // pull updated list from db\n    console.log(this.event_list)\n  }*/\n  openDialog() {\n    var _this4 = this;\n    const dialogRef = this.dialog.open(CreateEventComponent, {\n      width: '40%',\n      height: '70%',\n      data: {\n        new_event: this.new_event,\n        user: this.user\n      }\n    });\n    dialogRef.afterClosed().subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (result) {\n        console.log('The dialog was closed');\n        _this4.event_list = yield _this4.pullEvents(_this4.event_list);\n        _this4.new_event = result;\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n  checkSignin() {\n    if (this.user) {\n      this.pullEvents(this.event_list);\n    }\n  }\n  static #_ = this.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.MatDialog));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    decls: 15,\n    vars: 4,\n    consts: [[\"charset\", \"utf-8\"], [\"name\", \"viewport\", \"content\", \"width=device-width, initial-scale=1\"], [\"href\", \"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\", \"rel\", \"stylesheet\", \"integrity\", \"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\", \"crossorigin\", \"anonymous\"], [\"role\", \"banner\", 1, \"navbar\", \"toolbar\", \"container-fluid\"], [\"class\", \"button\", 4, \"ngIf\"], [1, \"title\"], [4, \"ngIf\"], [1, \"container-fluid\", \"home\"], [\"class\", \"row auth-container\", 4, \"ngIf\"], [1, \"button\"], [\"mat-raised-button\", \"\", \"color\", \"warn\", 3, \"click\"], [3, \"auth\"], [1, \"row\", \"auth-container\"], [3, \"event_list_init\", \"auth\"], [1, \"col-3\", \"nopadding\"], [1, \"limit_height\"], [3, \"event_list\", \"user\", \"event_list_joined\"], [1, \"col-9\", \"map\"], [3, \"user\", \"event_list\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"html\")(1, \"head\");\n        i0.ɵɵelement(2, \"meta\", 0)(3, \"meta\", 1)(4, \"link\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 3);\n        i0.ɵɵtemplate(6, AppComponent_div_6_Template, 3, 0, \"div\", 4);\n        i0.ɵɵelementStart(7, \"h1\", 5);\n        i0.ɵɵtext(8, \"Campus Meet\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(9, AppComponent_div_9_Template, 2, 0, \"div\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"body\")(11, \"div\", 7);\n        i0.ɵɵtemplate(12, AppComponent_div_12_Template, 2, 0, \"div\", 8);\n        i0.ɵɵtemplate(13, AppComponent_div_13_Template, 6, 4, \"div\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(14, \"router-outlet\");\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", ctx.user);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.user);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", !ctx.user);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.user);\n      }\n    },\n    dependencies: [i2.NgIf, i3.RouterOutlet, i4.MatButton, i5.AuthComponent, i6.MapComponent, i7.CardsComponent],\n    styles: [\"body[_ngcontent-%COMP%]{height:90vh;width:100wh}.container[_ngcontent-%COMP%]{height:100vh;min-height:100vh}.auth-container[_ngcontent-%COMP%]{height:90vh}.title[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto}.home[_ngcontent-%COMP%]{margin-top:10vh;height:90vh;padding:0;overflow:hidden}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{margin:8px 0}p[_ngcontent-%COMP%]{margin:0}.toolbar[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;padding-left:4;height:10vh;align-items:center;background-color:#00539f;color:#fff;font-weight:600}.button[_ngcontent-%COMP%]{top:0;left:0}.limit_height[_ngcontent-%COMP%]{max-height:90vh;overflow:auto}[_ngcontent-%COMP%]::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.3);border-radius:10px;background-color:#f5f5f5}[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px;background-color:#f5f5f5}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:10px;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.3);background-color:#00539f}.map[_ngcontent-%COMP%]{height:90vh;padding:0}.nopadding[_ngcontent-%COMP%]{padding:0}\"]\n  });\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}